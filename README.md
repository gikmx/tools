# [@gik/tools](https://github.com/gikmx/tools#readme) *0.2.1*
> Meta package for GIK's toolbelt

## Contributors
* [Héctor Menéndez](mailto:hector@gik.mx) [http://hectormenendez.com](http://hectormenendez.com)

# Usage

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Tools](#tools)
    -   [checker](#checker)
        -   [is](#is)
            -   [objectEmpty](#objectempty)
            -   [string](#string)
            -   [number](#number)
            -   [array](#array)
            -   [function](#function)
            -   [regexp](#regexp)
            -   [boolean](#boolean)
            -   [object](#object)
        -   [props](#props)
    -   [logger](#logger)
    -   [mapper](#mapper)
    -   [pupulator](#pupulator)
    -   [streamer](#streamer)
        -   [fromAccess](#fromaccess)
        -   [fromStat](#fromstat)
        -   [fromSpawn](#fromspawn)
        -   [fromDirMake](#fromdirmake)
        -   [fromDirRequire](#fromdirrequire)
        -   [fromDirRead](#fromdirread)
        -   [fromDirReadRecursive](#fromdirreadrecursive)
        -   [fromFileRead](#fromfileread)
        -   [fromFileWrite](#fromfilewrite)
    -   [thrower](#thrower)
        -   [Replacer](#replacer)
-   [Types](#types)
    -   [CheckerPropParamError](#checkerpropparamerror)
    -   [CheckerPropDefError](#checkerpropdeferror)
    -   [CheckerPropDefTypeError](#checkerpropdeftypeerror)
    -   [CheckerPropReqError](#checkerpropreqerror)
    -   [CheckerPropTypeError](#checkerproptypeerror)
    -   [LoggerParamTypeError](#loggerparamtypeerror)
    -   [LoggerInstance](#loggerinstance)
    -   [MapperParamError](#mapperparamerror)
    -   [MapperResult](#mapperresult)
    -   [PupulatorParamError](#pupulatorparamerror)
    -   [PopulatorKeyError](#populatorkeyerror)
    -   [PopulatorKeyTypeError](#populatorkeytypeerror)
    -   [NodeStat](#nodestat)
    -   [NodeOutput](#nodeoutput)
    -   [NodePath](#nodepath)
    -   [StreamBoolean](#streamboolean)
    -   [StreamString](#streamstring)
    -   [StreamStat](#streamstat)
    -   [StreamOutput](#streamoutput)
    -   [StreamPath](#streampath)
    -   [StreamParamError](#streamparamerror)

## Tools

> This is a meta package containign the following packages.

-   [tools-thrower](http://github.com/gikmx/tools-thrower)
-   [tools-checker](http://github.com/gikmx/tools-checker)
-   [tools-logger](http://github.com/gikmx/tools-logger)
-   [tools-streamer](http://github.com/gikmx/tools-streamer)
-   [tools-populator](http://github.com/gikmx/tools-populator)
-   [tools-mapper](http://github.com/gikmx/tools-mapper)

### checker

Gives you tools to determine the type of a value.

#### is

Gives you tools to determine the type of a value.

##### objectEmpty

Determine if an element is an object and has no keys

**Parameters**

-   `value` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** an object to be checked.

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### string

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### number

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### array

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### function

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### regexp

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### boolean

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

##### object

Determines if `value` is really a string.

**Parameters**

-   `value` **any** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

#### props

Validates properties of given object.

**Parameters**

-   `subject` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The object value whose properties will be inspected.
-   `defmap` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** An definition object map, describing each of the prop' types.
    -   `defmap.prop` **([Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))** The name of a corresponding subject's property.
               If a string is used, it will be converted to: `{ type: <string used>, required:true }`
    -   `defmap.type` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Determines the type the prop should have, all methods on `is()` are asupported. (optional, default `any`)
    -   `defmap.required` **bool** Wether the prop can be omitted. (optional, default `false`)
    -   `defmap.default` **any** The value to use if prop is omitted (cannot be used along `required`). (optional, default `undefined`)
    -   `defmap.map` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** A function that will receive subject's prop value and expects you
               to return acomputed value for it (optional, default `undefined`)

**Examples**

```javascript
const subject = { a: 1, b: 'hello' z: undefined };
const result = props(subject, {
    a: { type:'number', required:true },
    b: 'string',
    c: { default: new Date() },
    d: { required: false, default: null, map: value => [value, true] },
})
// result:
// { a: 1, b: 'hello', c: '1981-06-23 10:06:08', d: [null, true], z: undefined }
```

-   Throws **CheckerPropParamError** when invalid parameters are passed.
-   Throws **CheckerPropDefError** when a type definition is invalid.
-   Throws **CheckerPropDefTypeError** when a type defintiion is not supported.
-   Throws **CheckerPropReqError** when a required property is not found.
-   Throws **CheckerPropTypeError** when a property does not match the defintion.

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The validated subject extended with default values (when applies).

### logger

A wrapper around [pino](http://getpino.io) that behaves differently according to
currently set environment:

-   When the environment is _non-production_ it will output prettier logs.

-   All calls to `error` will use
    [@gik/tools-thrower](http://githib.com/gikmx/tools-thrower)
    halting the execution when the environment is _non-production_ (ie: development)
    however, when in production, it will fallback to Pino's default logger.

-   When the environment is set as _production_ it will load
    [extreme-mode](http://getpino.io/#/docs/extreme)
    adding an even faster approach to logging. (make sure to read the documentation
    about the caveats)

-   In all environments captures all calls to [debug](https://github.com/visionmedia/debug)
    to improve their performance and avoid having to pass the DEBUG environment variable.
    _NOTE:_ In order for this to work, this lib should be loaded before any other modules.

**Parameters**

-   `config` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The default configuration applied for every environment.
           [additional params](http://getpino.io/#/docs/API?id=constructor)
    -   `config.name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** The name for the returned logger instance.
               By default, it will first try to determine the current process' package
               name, if that fails, then it will use the current process' dirname.
    -   `config.level` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The level of debugging that should be used
               supported levels are:
               `silent`, `fatal`, `error`, `warn`, `info`, `debug`, `trace`.       you can also set the level using the LEVEL environment variable.
               `~$ LEVEL=info node /path/to/your/file.js`.

               **NOTE**: using trace would enable all `debug` messages sent by the modules. (optional, default `info`)
-   `safe` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Avoid errors caused by circular-references. (optional, default `true`)


-   Throws **LoggerParamTypeError** 

Returns **LoggerInstance** 

### mapper

Generates an object containing a map for all the properties available on `subject`.

**Parameters**

-   `subject` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The object you want to map.

**Examples**

```javascript
const subject = {
    a: {
        b: {
           d: true,
           e:  {
               g: 'foo'
           }
        },
        f: undefined,
    }
};
const result = Mapper(subject);
// result:
// { 'a.b.d': true, 'a.b.e.g': 'foo', 'a.f': undefined }
```

-   Throws **mapperTypeError** 

Returns **mapperResult** 

### pupulator

Allows properties in an object to inherit values from sibling properties.
This specially useful when creating JSON configuration files.

**Parameters**

-   `subject` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The object you need to be populated.

**Examples**

```javascript
const subject = {
    a: { b: { c: 'world' } },
    d: "hello ${a.b.c}${e}",
    e: "!!!",
};
const result = Populator(subject);
// result:
// { a: { b: { c: 'world' } }, d: "hello world!!!", e: "!!!" };
```

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### streamer

An utility belt for our most common operations with Observables, using RxJS.<br>

TODO:

-   Add unit tests for all methods.

#### fromAccess

Determine if given path is accessible.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** A path to the node you want to check.

Returns **StreamBoolean** Wether the file is accessible or not.

#### fromStat

Determine statistics about a file system node.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** A path to the node you want to check.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When given an invalid node.

Returns **StreamStat** stat object for the node.

#### fromSpawn

Spawn a shell command.

**Parameters**

-   `command` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The command you wish to spawn.
-   `config` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** Configs sent to spawn command.

Returns **StreamOutput** Each chunk of either stdout or stderr data.

#### fromDirMake

Creates a directory.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The directory to be created.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When directory cannot be created.

Returns **StreamString** The path of the directory that was just created.

#### fromDirRequire

Requires a directory path, if the directory does not exists, it's created.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The requested directory.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When requested path exists and is not a directory.

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;StreamString>** The path of the directory.

#### fromDirRead

Get path of nodes in given directory (non recursively).

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The requested directory.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When requested path exists and is not a directory.

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;StreamDirNode>** The path of the directory.

#### fromDirReadRecursive

Get path of nodes in given directory (recursively).

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The requested directory.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When requested path exists and is not a directory.

Returns **StreamPath** The path of the directory.

#### fromFileRead

Reads a file from the disk.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The path to the file to read.

Returns **Observable&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** The contents of the file.

#### fromFileWrite

Writes a file on the disk.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The full path for the file.
-   `content` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The contents of the file.


-   Throws **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** When the file cannot be written.

Returns **Observable&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** The future value `true` if write was succesful.

### thrower

Returns an error with easier to read stack, and with an optional custom name.

**Parameters**

-   `subject` **([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array) \| [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error))** The message or an Error instance to beautify.
    When an array is sent, replace subject ALA printf. signature:`[subject, ...replacements]`
-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** An identifier for the error instance. (optional, default `'Error'`)
-   `throws` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** If false, return error instance instead of throwing. (optional, default `true`)

**Examples**

```javascript
Thrower('test'); // A standard Error with prettified stack
Thrower(new TypeError('test2')); // Standard TypeError with prettified stack
Thrower('test3', 'TestError'); // Custom TestError with 'test3' as message
Thrower(['hola %s', 'mundo'], 'HelloError'); // HelloError with 'hola mundo' as message
const Err = Thrower('bad boy', 'CanineError', false); // Returns CanineError instance.
```

Returns **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** A custom error instance with a pretty stack.

#### Replacer

This is the replacement function used internally when an array subject is sent.

**Parameters**

-   `message` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `replacements` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## Types

These are the available types for the tools.

### CheckerPropParamError

An expected argument for props was invalid or not provided.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### CheckerPropDefError

A definition prop was sent, but it was invalid.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### CheckerPropDefTypeError

The specified type is not a supported primitive.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### CheckerPropReqError

A required property was not found in subject.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### CheckerPropTypeError

A property didn't have the correct type.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### LoggerParamTypeError

Thrown when a non-object configuration is sent to the logger.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### LoggerInstance

An instance of the logger (see [Pino](http://getpino.io))

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

### MapperParamError

The subject passeed to the Mapper is not the expected type.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### MapperResult

A map to all the properties contained in an object.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

### PupulatorParamError

The provided `subject` to the Populator is not the expected type.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### PopulatorKeyError

The provided key cannot be used to populate the current property.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### PopulatorKeyTypeError

The provided key cannot be used because is not a valid type.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

### NodeStat

A stream containing stat from node.
see [fs.stat](https://nodejs.org/api/fs.html#fs_class_fs_stats) for more properties.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `isDirectory` **function (void)** Determine if node is a directory.
-   `isFile` **function (void)** Determine if node is a file.

### NodeOutput

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `type` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The type of chunk that is being received. (stderr || stdout)
-   `data` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The actual output.

### NodePath

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The full path for the node
-   `data` **NodeStat** The actual output.

### StreamBoolean

Type: Observable&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>

### StreamString

Type: Observable&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### StreamStat

A stream containing stat from node.

Type: Observable&lt;NodeStat>

### StreamOutput

A stream containing stat from node.

Type: Observable&lt;NodeOutput>

### StreamPath

A stream containing stat from node.

Type: Observable&lt;NodePath>

### StreamParamError

Thrown when a parameter is not the correct type.

Type: [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)
